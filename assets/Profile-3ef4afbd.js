import{m as F,P as ce,e as j,f as E,U as he,b as P,r as y,i as _,a as b,j as s,N as W,d as e,n as m,B as h,O as ue,Q as X,V as C,o as c,X as Z,Y as me,Z as pe,_ as J,$ as K,a0 as xe,a1 as R,a2 as I,h as ve,W as ge,a3 as fe,a4 as Ce,a5 as ye,a6 as _e,a7 as be,a8 as we,I as Se,a9 as Pe,y as Fe,aa as Re,ab as H}from"./index-da64fe47.js";import{d as L,R as $}from"./ExpandMore-634c78b3.js";import{P as $e,u as Ue,a as Ee,b as je,G as ke,c as Ae,C as Me,d as De,e as Oe}from"./Landing-24e2abe3.js";import{I as Q,a as G,H as ze,S as Te}from"./mutations-4662eaba.js";import{C as Ne}from"./Container-ec43f813.js";const qe=(t,i)=>{const{data:a,refetch:n,loading:p}=F(ce,{variables:{profilId:t,viewerId:i},skip:!t||!i});return{data:a==null?void 0:a.profile,loading:p,refetch:n}},Be=()=>{const{user:t,dispatchSnack:i}=j(),[a,{error:n}]=E(he),p=async l=>{var g;const d=await a({variables:{userId:t==null?void 0:t.id,updateUserInput:l}});i({open:!0,severity:"success",message:(g=d==null?void 0:d.data)==null?void 0:g.updateUser})};return P.useEffect(()=>{n!=null&&n.message&&i({open:!0,severity:"error",message:n==null?void 0:n.message})},[n]),{updateUser:p}};var k={},Ve=_;Object.defineProperty(k,"__esModule",{value:!0});var ee=k.default=void 0,He=Ve(y()),Le=b,Qe=(0,He.default)((0,Le.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"PersonAdd");ee=k.default=Qe;var A={},Ge=_;Object.defineProperty(A,"__esModule",{value:!0});var te=A.default=void 0,Ye=Ge(y()),We=b,Xe=(0,Ye.default)((0,We.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"People");te=A.default=Xe;var M={},Ze=_;Object.defineProperty(M,"__esModule",{value:!0});var ae=M.default=void 0,Je=Ze(y()),Ke=b,Ie=(0,Je.default)((0,Ke.jsx)("path",{fillRule:"evenodd",d:"m9 17 3-2.94c-.39-.04-.68-.06-1-.06-2.67 0-8 1.34-8 4v2h9l-3-3zm2-5c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m4.47 8.5L12 17l1.4-1.41 2.07 2.08 5.13-5.17 1.4 1.41z"}),"HowToReg");ae=M.default=Ie;var D={},et=_;Object.defineProperty(D,"__esModule",{value:!0});var ie=D.default=void 0,tt=et(y()),at=b,it=(0,tt.default)((0,at.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"}),"Email");ie=D.default=it;var O={},rt=_;Object.defineProperty(O,"__esModule",{value:!0});var re=O.default=void 0,nt=rt(y()),st=b,ot=(0,nt.default)((0,st.jsx)("path",{d:"M14.4 6 14 4H5v17h2v-7h5.6l.4 2h7V6z"}),"Flag");re=O.default=ot;var z={},dt=_;Object.defineProperty(z,"__esModule",{value:!0});var ne=z.default=void 0,lt=dt(y()),Y=b,ct=(0,lt.default)([(0,Y.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"},"0"),(0,Y.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"QueryBuilder");ne=z.default=ct;const ht=({userInfo:t,sx:i,...a})=>s(W,{elevation:1,sx:{p:1,...i},...a,children:[e(m,{variant:"h4",textAlign:"center",children:"Information du compte:"}),s(h,{sx:{p:1},children:[s(m,{sx:{display:"flex",alignItems:"center"},children:[e(ie,{sx:{mr:1}}),"Addresse email: ",e("strong",{children:t==null?void 0:t.email})]}),(t==null?void 0:t.civilite)&&s(m,{sx:{display:"flex",alignItems:"center"},children:[e(re,{sx:{mr:1}}),"Nationalité: ",e("strong",{children:t==null?void 0:t.civilite})]}),s(m,{sx:{display:"flex",alignItems:"center"},children:[e(ne,{sx:{mr:1}}),"Membre depuis",ue(t==null?void 0:t.createdAt).format("DD MMMM YYYY ")]})]})]}),ut=()=>s(X,{spacing:1,sx:{p:1},children:[e(h,{sx:{my:1},children:e(C,{variant:"text",sx:{fontSize:"1rem",width:"100%"}})}),[1,2,3].map(t=>e(C,{variant:"text",sx:{fontSize:"1rem",width:"100%"}},t))]}),mt=()=>s(X,{spacing:1,sx:{p:1},children:[e(h,{sx:{my:1},children:e(C,{variant:"text",sx:{fontSize:"1rem",width:"100%"}})}),e(c,{container:!0,children:[1,2,3,4,5,6].map(t=>s(c,{item:!0,xs:4,sx:{p:1},children:[e(C,{variant:"rounded",sx:{width:"100%",height:"180px"}}),e(C,{variant:"text",sx:{fontSize:"0.5rem",width:"100%"}})]},t))})]}),pt=({friends:t,user:i,sx:a,...n})=>{const p=Z();return s(W,{elevation:1,sx:{p:1,...a},...n,children:[e(me,{title:e(m,{variant:"h4",textAlign:"center",children:"Amis"})}),e(pe,{children:e(c,{container:!0,children:t==null?void 0:t.map(l=>e(c,{item:!0,xs:4,sx:{p:1},children:s(h,{onClick:()=>p(`/subscription-graphql/landing/profil/${l.id}`),sx:{width:"100%",height:"180px",borderRadius:"10px",cursor:"pointer"},children:[e(h,{component:"img",src:l.photo?J(l.photo):K,sx:{width:"100%",height:"70%",objectFit:"cover",borderRadius:"10px"}}),e(m,{children:(i==null?void 0:i.id)===l.id?"Vous":`${l.firstname} ${l.lastname}`})]})},l.id))})}),(t==null?void 0:t.length)===10&&e(xe,{sx:{justifyContent:"center"},children:e(R,{sx:{width:"100%"},children:"Voir tout"})})]})},xt=()=>{const{user:t}=j(),{id:i}=I(),{data:a,refetch:n,fetchMore:p,loading:l}=F($e,{variables:{userId:parseFloat(i)},skip:!i,notifyOnNetworkStatusChange:!0}),{createPost:d}=Ue(),{addReact:g}=Ee(),{commentExec:r}=je(),o=P.useCallback(async(u,v)=>{await g(u,t==null?void 0:t.id,v),await n()},[t]),{data:x}=ve(ke,{variables:{userId:t==null?void 0:t.id},skip:!(t!=null&&t.id)}),T=P.useCallback(async(u,v)=>{await r({variables:{postId:u,userId:t==null?void 0:t.id,commentInput:v}}),await n()},[t]),N=async(u,v)=>{await d(u,v),await n()};return s(h,{children:[parseFloat(i)===(t==null?void 0:t.id)&&e(Ae,{createPost:N}),s(Me.Provider,{value:{commentPost:T,data:x},children:[a==null?void 0:a.postByUser.map((u,v)=>s(P.Fragment,{children:[e(De,{user:t,addReact:o,post:u,sx:{p:2,width:{xs:350,md:500},my:1}},u.id),v===(a==null?void 0:a.postByUser.length)-1&&a.postByUser.length===10&&e(ge,{onEnter:()=>p({variables:{cursor:a.postByUser[a.postByUser.length-1].id},updateQuery(U,{fetchMoreResult:w}){return w?{postByUser:[...U.postByUser,...w.postByUser]}:U}})})]},u.id)),l&&[1,2,3,4].map(u=>e(Oe,{},u))]})]})},vt=({loading:t,userInfo:i,user:a})=>s(c,{container:!0,children:[s(c,{item:!0,xs:12,md:5,sx:{p:1},children:[t&&e(ut,{}),e(ht,{userInfo:i==null?void 0:i.user}),t&&e(mt,{}),e(pt,{friends:i==null?void 0:i.friends,user:a,sx:{my:1}})]}),e(c,{item:!0,xs:12,md:7,sx:{p:1},children:e(xt,{})})]}),gt=({profilId:t,user:i})=>{const a=Z(),{data:n,loading:p,fetchMore:l}=F(fe,{variables:{userId:t,receiverId:i==null?void 0:i.id},skip:!t||!(i!=null&&i.id),notifyOnNetworkStatusChange:!0}),{data:d,loading:g,fetchMore:r}=F(Ce,{variables:{userId:t},skip:!t,notifyOnNetworkStatusChange:!0});return s(h,{children:[t!==(i==null?void 0:i.id)&&s(h,{children:[e(m,{variant:"h4",sx:{my:1},children:"Amis en commun"}),s(c,{container:!0,children:[n==null?void 0:n.getCommonFriends.map(o=>e(c,{item:!0,xs:3,sx:{p:1},children:e(Q,{user:o,actions:e(R,{onClick:()=>a(`/subscription-graphql/landing/profil/${o.id}`),variant:"outlined",sx:{width:"100%"},children:"Voir profil"})})},o.id)),p&&[1,2,3,4].map(o=>e(c,{item:!0,xs:12,sm:4,md:3,sx:{p:1},children:e(G,{})},o)),(n==null?void 0:n.getCommonFriends.length)===10&&s(c,{item:!0,xs:12,onClick:()=>l({variables:{cursor:n==null?void 0:n.getCommonFriends[n.getCommonFriends.length-1].id},updateQuery:(o,{fetchMoreResult:x})=>x?{getCommonFriends:[...o.getCommonFriends,...x.getCommonFriends]}:o}),sx:{display:"flex",justifyContent:"center",my:1,py:1,borderRadius:"15px",alignItems:"center",cursor:"pointer",":hover":{backgroundColor:"lightgrey"}},children:[e(m,{variant:"h5",children:"Afficher plus"}),e(L,{})]})]})]}),s(h,{sx:{my:1},children:[e(m,{variant:"h4",sx:{my:1},children:"Tous les amis"}),s(c,{container:!0,children:[d==null?void 0:d.getFriendOfCurrentUser.map(o=>e(c,{item:!0,xs:3,sx:{p:1},children:e(Q,{user:o,actions:e(R,{onClick:()=>a(`/subscription-graphql/landing/profil/${o.id}`),variant:"outlined",sx:{width:"100%"},children:"Voir profil"})})},o.id)),g&&[1,2,3,4].map(o=>e(c,{item:!0,xs:12,sm:4,md:3,sx:{p:1},children:e(G,{})},o)),(d==null?void 0:d.getFriendOfCurrentUser.length)===10&&s(c,{item:!0,xs:12,onClick:()=>r({variables:{cursor:d==null?void 0:d.getFriendOfCurrentUser[d.getFriendOfCurrentUser.length-1].id},updateQuery:(o,{fetchMoreResult:x})=>x?{getFriendOfCurrentUser:[...o.getFriendOfCurrentUser,...x.getFriendOfCurrentUser]}:o}),sx:{display:"flex",justifyContent:"center",my:1,py:1,borderRadius:"15px",alignItems:"center",cursor:"pointer",":hover":{backgroundColor:"lightgrey"}},children:[e(m,{variant:"h5",children:"Afficher plus"}),e(L,{})]})]})]})]})},ft=(t,i,a)=>{switch(t==null?void 0:t.status){case $.PENDING:return{label:i===a?"Invitation envoyée":"Confirmer l'invitation",icon:e(ae,{sx:{fill:"white"}})};case $.ACCEPTED:return{label:"Ami",icon:e(te,{color:"primary"})};default:return{label:"Ajouter comme ami",icon:e(ee,{sx:{fill:"white"}})}}},St=()=>{var q;const t=ye(),{id:i}=I(),{user:a,setUser:n}=j(),[p,{loading:l}]=E(ze),[d,{loading:g}]=E(Te),{data:r,refetch:o,loading:x}=qe(i?parseFloat(i):void 0,a==null?void 0:a.id),{register:T,formState:{errors:N},reset:u,getValues:v,handleSubmit:U}=_e(),{updateUser:w}=Be(),se=async f=>{var V;const le=v();await w({...le,photo:f[0].url});const{data:B}=await o();a&&B.profile&&n({...a,photo:(V=B.profile)==null?void 0:V.user.photo})},{icon:oe,label:S}=ft(r==null?void 0:r.relation,a==null?void 0:a.id,(q=r==null?void 0:r.relation)==null?void 0:q.userId),de=async()=>{var f;!a||!(r!=null&&r.user)||(r.relation?await p({variables:{friendRequestId:(f=r.relation)==null?void 0:f.id,status:S==="Confirmer l'invitation"?$.ACCEPTED:$.DENIED}}):await d({variables:{userId:a==null?void 0:a.id,receiverId:r.user.id}}),await o())};return s(Ne,{children:[e(h,{sx:{display:"flex",my:2,justifyContent:"center",alignItems:"center"},children:s(h,{sx:{width:200,height:200,position:"relative",mr:2},children:[x&&e(C,{variant:"circular",sx:{width:"100%",height:"100%"}}),e(be,{alt:(r==null?void 0:r.user.firstname)||"profile",src:J((r==null?void 0:r.user.photo)??void 0)||K,sx:{width:"100%",height:"100%"}}),i&&parseFloat(i)===(a==null?void 0:a.id)&&e(h,{sx:{width:"max-content",position:"absolute",bottom:0,right:0},children:e(we,{onFinished:se,children:e(Se,{children:e(Pe,{sx:{fill:t.palette.primary.main}})})})})]})}),s(m,{fontWeight:"bold",fontSize:"1.5em",sx:{textAlign:"center"},children:[r==null?void 0:r.user.firstname," ",r==null?void 0:r.user.lastname]}),i&&parseFloat(i)!==(a==null?void 0:a.id)&&e(h,{sx:{display:"flex",justifyContent:"center",my:1},children:s(R,{onClick:de,variant:S==="Ami"?"outlined":"contained",sx:{textTransform:"none"},children:[g||l?e(Fe,{sx:{fill:"white"}}):e(m,{sx:{color:f=>S==="Ami"?f.palette.primary.main:"white",mr:1},children:S}),oe]})}),s(Re,{children:[e(H,{index:!0,element:e(vt,{loading:x,user:a,userInfo:r})}),e(H,{path:"friends",element:e(gt,{profilId:i?parseFloat(i):void 0,user:a})})]})]})};export{St as default};
